##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1.4, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"),lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.29 ns", cex=1.5)
mtext(c("lineages 5%"), side = 3, col = "black", line = 1, cex = 1.7)
mtext(c("Diptera"), side = 4, col = "black", line = 2, cex = 1.7)
#
#**Hymenoptera**
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/community_Hymenoptera_Groups_h.txt")->community_Hymenoptera_Groups_h
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Hymenoptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.008 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera3P/community_Hymenoptera_Groups0.03.txt")->community_Hymenoptera_Groups0.03
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Hymenoptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.026 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera5P/community_Hymenoptera_Groups0.05.txt")->community_Hymenoptera_Groups0.05
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Hymenoptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.027 ns", cex=1.5)
mtext(c("Hymenoptera"), side = 4, col = "black", line = 2, cex = 2)
## Legend
#legend(0.8, 0.4, xpd=NA,
#       legend = c("DNA from large", "DNA from small", "pool", "Tlacotepec"),
#       col=c("#153a7b", "#eaa22f", "#97518b", "#81b9d0"),
#       bty="n", text.font=2, lty=1, lwd= 8, cex = 2.5)
dev.off()
#
#**Non-Metric Multidimensional scaling (NMDS) ordinations of community similarity**
png(filename="../figures/Figure3_Non_MetricMultidimensionalScaling.png", width=620, height=460, units="px") # set size of the file to plot
par(mfrow=c(2,3), mar = c(1.8, 1.8, 1.8, 1.8), omi=c(0.3, 0.3, 0.3, 0.3)) #the number of rows and columns the figure would have
#**Creating plot**
#**Diptera**
read.table ("../genetic/Data_out/Diptera/Diptera_Haplotypes/community_Diptera_Groups_h.txt")->community_Diptera_Groups_h
read.table("../genetic/Data_out/Diptera/Diptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Diptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.129 ns", cex=1.5)
mtext(c("Haplotypes"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera3P/community_Diptera_Groups0.03.txt")->community_Diptera_Groups0.03
read.table("../genetic/Data_out/Diptera/Diptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Diptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.24 ns", cex=1.5)
mtext(c("lineages 3%"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera5P/community_Diptera_Groups0.05.txt")->community_Diptera_Groups0.05
read.table("../genetic/Data_out/Diptera/Diptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Diptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1.4, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"),lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.29 ns", cex=1.5)
mtext(c("lineages 5%"), side = 3, col = "black", line = 1, cex = 1.7)
mtext(c("Diptera"), side = 4, col = "black", line = 2, cex = 1.7)
#
#**Hymenoptera**
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/community_Hymenoptera_Groups_h.txt")->community_Hymenoptera_Groups_h
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Hymenoptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.008 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera3P/community_Hymenoptera_Groups0.03.txt")->community_Hymenoptera_Groups0.03
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Hymenoptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.026 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera5P/community_Hymenoptera_Groups0.05.txt")->community_Hymenoptera_Groups0.05
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Hymenoptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.027 ns", cex=1.5)
mtext(c("Hymenoptera"), side = 4, col = "black", line = 2, cex = 2)
## Legend
#legend(0.8, 0.4, xpd=NA,
#       legend = c("DNA from large", "DNA from small", "pool", "Tlacotepec"),
#       col=c("#153a7b", "#eaa22f", "#97518b", "#81b9d0"),
#       bty="n", text.font=2, lty=1, lwd= 8, cex = 2.5)
dev.off()
#
#**Non-Metric Multidimensional scaling (NMDS) ordinations of community similarity**
png(filename="../figures/Figure3_Non_MetricMultidimensionalScaling.png", width=620, height=460, units="px") # set size of the file to plot
par(mfrow=c(2,3), mar = c(1.8, 1.8, 1.8, 1.8), omi=c(0.3, 0.3, 0.3, 0.3)) #the number of rows and columns the figure would have
#**Creating plot**
#**Diptera**
read.table ("../genetic/Data_out/Diptera/Diptera_Haplotypes/community_Diptera_Groups_h.txt")->community_Diptera_Groups_h
read.table("../genetic/Data_out/Diptera/Diptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Diptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.129 ns", cex=1.5)
mtext(c("Haplotypes"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera3P/community_Diptera_Groups0.03.txt")->community_Diptera_Groups0.03
read.table("../genetic/Data_out/Diptera/Diptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Diptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.24 ns", cex=1.5)
mtext(c("lineages 3%"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera5P/community_Diptera_Groups0.05.txt")->community_Diptera_Groups0.05
read.table("../genetic/Data_out/Diptera/Diptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Diptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1.4, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"),lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.29 ns", cex=1.5)
mtext(c("lineages 5%"), side = 3, col = "black", line = 1, cex = 1.7)
mtext(c("Diptera"), side = 4, col = "black", line = 2, cex = 1.7)
#
#**Hymenoptera**
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/community_Hymenoptera_Groups_h.txt")->community_Hymenoptera_Groups_h
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Hymenoptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.008 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera3P/community_Hymenoptera_Groups0.03.txt")->community_Hymenoptera_Groups0.03
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Hymenoptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.026 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera5P/community_Hymenoptera_Groups0.05.txt")->community_Hymenoptera_Groups0.05
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Hymenoptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.027 ns", cex=1.5)
mtext(c("Hymenoptera"), side = 4, col = "black", line = 2, cex = 2)
## Legend
#legend(0.8, 0.4, xpd=NA,
#       legend = c("DNA from large", "DNA from small", "pool", "Tlacotepec"),
#       col=c("#153a7b", "#eaa22f", "#97518b", "#81b9d0"),
#       bty="n", text.font=2, lty=1, lwd= 8, cex = 2.5)
dev.off()
#
#**Non-Metric Multidimensional scaling (NMDS) ordinations of community similarity**
png(filename="../figures/Figure3_Non_MetricMultidimensionalScaling.png", width=620, height=460, units="px") # set size of the file to plot
par(mfrow=c(2,3), mar = c(1.8, 1.8, 1.8, 1.8), omi=c(0.3, 0.3, 0.3, 0.3)) #the number of rows and columns the figure would have
#**Creating plot**
#**Diptera**
read.table ("../genetic/Data_out/Diptera/Diptera_Haplotypes/community_Diptera_Groups_h.txt")->community_Diptera_Groups_h
read.table("../genetic/Data_out/Diptera/Diptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Diptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.129 ns", cex=1.5)
mtext(c("Haplotypes"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera3P/community_Diptera_Groups0.03.txt")->community_Diptera_Groups0.03
read.table("../genetic/Data_out/Diptera/Diptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Diptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.24 ns", cex=1.5)
mtext(c("lineages 3%"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera5P/community_Diptera_Groups0.05.txt")->community_Diptera_Groups0.05
read.table("../genetic/Data_out/Diptera/Diptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Diptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1.4, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"),lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.29 ns", cex=1.5)
mtext(c("lineages 5%"), side = 3, col = "black", line = 1, cex = 1.7)
mtext(c("Diptera"), side = 4, col = "black", line = 2, cex = 1.7)
#
#**Hymenoptera**
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/community_Hymenoptera_Groups_h.txt")->community_Hymenoptera_Groups_h
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Hymenoptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.008 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera3P/community_Hymenoptera_Groups0.03.txt")->community_Hymenoptera_Groups0.03
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Hymenoptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.026 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera5P/community_Hymenoptera_Groups0.05.txt")->community_Hymenoptera_Groups0.05
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Hymenoptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.027 ns", cex=1.5)
mtext(c("Hymenoptera"), side = 4, col = "black", line = 2, cex = 2)
## Legend
#legend(0.8, 0.4, xpd=NA,
#       legend = c("DNA from large", "DNA from small", "pool", "Tlacotepec"),
#       col=c("#153a7b", "#eaa22f", "#97518b", "#81b9d0"),
#       bty="n", text.font=2, lty=1, lwd= 8, cex = 2.5)
dev.off()
#
#**Non-Metric Multidimensional scaling (NMDS) ordinations of community similarity**
png(filename="../figures/Figure3_Non_MetricMultidimensionalScaling.png", width=620, height=460, units="px") # set size of the file to plot
par(mfrow=c(2,3), mar = c(1.8, 1.8, 1.8, 1.8), omi=c(0.3, 0.3, 0.3, 0.3)) #the number of rows and columns the figure would have
#**Creating plot**
#**Diptera**
read.table ("../genetic/Data_out/Diptera/Diptera_Haplotypes/community_Diptera_Groups_h.txt")->community_Diptera_Groups_h
read.table("../genetic/Data_out/Diptera/Diptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Diptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.129 ns", cex=1.5)
mtext(c("Haplotypes"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera3P/community_Diptera_Groups0.03.txt")->community_Diptera_Groups0.03
read.table("../genetic/Data_out/Diptera/Diptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Diptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.24 ns", cex=1.5)
mtext(c("lineages 3%"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera5P/community_Diptera_Groups0.05.txt")->community_Diptera_Groups0.05
read.table("../genetic/Data_out/Diptera/Diptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Diptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1.4, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"),lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.29 ns", cex=1.5)
mtext(c("lineages 5%"), side = 3, col = "black", line = 1, cex = 1.7)
mtext(c("Diptera"), side = 4, col = "black", line = 2, cex = 1.7)
#
#**Hymenoptera**
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/community_Hymenoptera_Groups_h.txt")->community_Hymenoptera_Groups_h
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Hymenoptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.008 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera3P/community_Hymenoptera_Groups0.03.txt")->community_Hymenoptera_Groups0.03
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Hymenoptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.026 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera5P/community_Hymenoptera_Groups0.05.txt")->community_Hymenoptera_Groups0.05
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Hymenoptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.027 ns", cex=1.5)
mtext(c("Hymenoptera"), side = 4, col = "black", line = 2, cex = 2)
## Legend
#legend(0.8, 0.4, xpd=NA,
#       legend = c("DNA from large", "DNA from small", "pool", "Tlacotepec"),
#       col=c("#153a7b", "#eaa22f", "#97518b", "#81b9d0"),
#       bty="n", text.font=2, lty=1, lwd= 8, cex = 2.5)
dev.off()
#
#**Non-Metric Multidimensional scaling (NMDS) ordinations of community similarity**
png(filename="../figures/Figure3_Non_MetricMultidimensionalScaling.png", width=620, height=460, units="px") # set size of the file to plot
par(mfrow=c(2,3), mar = c(1.8, 1.8, 1.8, 1.8), omi=c(0.3, 0.3, 0.3, 0.3)) #the number of rows and columns the figure would have
#**Creating plot**
#**Diptera**
read.table ("../genetic/Data_out/Diptera/Diptera_Haplotypes/community_Diptera_Groups_h.txt")->community_Diptera_Groups_h
read.table("../genetic/Data_out/Diptera/Diptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Diptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.129 ns", cex=1.5)
mtext(c("Haplotypes"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera3P/community_Diptera_Groups0.03.txt")->community_Diptera_Groups0.03
read.table("../genetic/Data_out/Diptera/Diptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Diptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.24 ns", cex=1.5)
mtext(c("lineages 3%"), side = 3, col = "black", line = 1, cex = 1.7)
read.table ("../genetic/Data_out/Diptera/Diptera5P/community_Diptera_Groups0.05.txt")->community_Diptera_Groups0.05
read.table("../genetic/Data_out/Diptera/Diptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Diptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Diptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1.4, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"),lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.29 ns", cex=1.5)
mtext(c("lineages 5%"), side = 3, col = "black", line = 1, cex = 1.7)
mtext(c("Diptera"), side = 4, col = "black", line = 2, cex = 1.7)
#
#**Hymenoptera**
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/community_Hymenoptera_Groups_h.txt")->community_Hymenoptera_Groups_h
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera_Haplotypes/general_sample_Mountain2Groups_h.txt",header=TRUE)->general_sample_Mountain2Groups_h
beta.multi(community_Hymenoptera_Groups_h, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups_h, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_Gh ##NMDS
plot (MDSbetasim_Gh, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups_h,ordispider(MDSbetasim_Gh, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.008 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera3P/community_Hymenoptera_Groups0.03.txt")->community_Hymenoptera_Groups0.03
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera3P/general_sample_Mountain2Groups0.03.txt",header=TRUE)->general_sample_Mountain2Groups0.03
beta.multi(community_Hymenoptera_Groups0.03, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.03, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.03 ##NMDS
plot (MDSbetasim_G0.03, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.03,ordispider(MDSbetasim_G0.03, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.026 ns", cex=1.5)
read.table ("../genetic/Data_out/Hymenoptera/Hymenoptera5P/community_Hymenoptera_Groups0.05.txt")->community_Hymenoptera_Groups0.05
read.table("../genetic/Data_out/Hymenoptera/Hymenoptera5P/general_sample_Mountain2Groups0.05.txt",header=TRUE)->general_sample_Mountain2Groups0.05
beta.multi(community_Hymenoptera_Groups0.05, index.family="sorensen")
##turnover by pairs, nmds, anosim
beta.pair(community_Hymenoptera_Groups0.05, index.family="sorensen")->beta.pair  ##betadiversity by pair of communities using sorensen on the precense/absence data, with estimation of turnover and nestedness datamatrixes simultaneously
metaMDS (beta.pair$beta.sim)->MDSbetasim_G0.05 ##NMDS
plot (MDSbetasim_G0.05, xlim=c(-0.5, 0.5), ylim=c(-0.5, 0.5), cex=2, cex.lab=1, cex.axis=2.3, lwd=4.5)
with(general_sample_Mountain2Groups0.05,ordispider(MDSbetasim_G0.05, Mountain2, cex.lab=1, col= c("#153a7b", "#eaa22f", "#81b9d0"), lwd=4.5))
##I put letter "r" in cursive and r2 value
mylabel = bquote(italic(r)^2)
text(x=0.10, y=-0.45, labels = mylabel, cex=1.5)
text(x=0.35, y=-0.45, labels="=0.027 ns", cex=1.5)
mtext(c("Hymenoptera"), side = 4, col = "black", line = 2, cex = 2)
## Legend
#legend(0.8, 0.4, xpd=NA,
#       legend = c("DNA from large", "DNA from small", "pool", "Tlacotepec"),
#       col=c("#153a7b", "#eaa22f", "#97518b", "#81b9d0"),
#       bty="n", text.font=2, lty=1, lwd= 8, cex = 2.5)
dev.off()
#
